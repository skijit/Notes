MongoDB Intro
=================

- [src1](https://www.youtube.com/watch?v=pWbMrx5rVBE)
- document database
- big advantage over relational: easy to scale
- installation for windows:
    - download
    - chooses a custom install target folder    
    - create additional folders in install target:
        - data
            - db
        - log
    - open up cmd.exe w/ admin permissions
        - navigate to the bin folder
        - `mongod --directoryperdb --dbpath C:\path-to-the-db-directory --logpath C:\path-to-the-log-dir\mongo.log --logappend --rest --install`
            - this allows us to run it as a service
        - `net start MongoDb`
            - this starts the service running
    - You can start the mongo shell by going to the bin directory and executing `mongo`
- Mongo shell commands
    - `cls` will clear everything
    - `show dbs` will show you the list dbs (don't touch the local)
    - `use mycustomers` will create a db called 'mycustomers' and switch you to using it
    - `db` will tell you what database you're currently using
- Dealing with records
    - arrays
    - strings
    - objects

```(javascript)
{
    firstName: "John",
    lastName: "Doe",
    memberships: ["mem1", "mem2"],
    address: {
        street: "blah blah"
        city: "Las Whateverus"
    },
    contacts: [
        { name: "Brad", relationship: friend}
    ]

}
```

- Creating users

```(javascript)
db.createUser({
    user: "Brad",
    pwd: "1234",
    roles: ["readWrite", "dbAdmin"]
})
```

    - see the [docs.mongodb.com](https://docs.mongodb.com/manual/reference/method/db.createUser/index.html) for info on how to use this

- Add a collection (like a table)
    - `db.createCollection('customers');`
    - `show collections` to see the various collections in the current db
    - `db.customers.insert({first_name: "John", last_name: "Smith"}); ` to add a record to a collection
        - you could also insert records with an array as a parameter
        - notice you're schema free, some records can have different fields
    - `db.customers.find();` will show you all the records in the collection
        - each record will have an autogenerated `_id` field
    - `db.customers.find().pretty();` will pretty-print the output
- Updating records
    - `db.customers.update({first_name:"John"}, {first_name:"John", last_name:"Doe", gender: "M" })`
        - first parameter identifies the records you want to update
        - second parameter tells you the fields 
            - in this case, the corresponding record(s) and all it's fields will be overwritten with whatever is in the 2nd parameter.
            - if you want to only affect some of the fields, you can use set operator...
    - $set operator:
        - `db.customers.update({first_name:"John"},{$set:{gender:"male"}})`
            - so this will only update the 'gender' field
    - $inc operator:
        - `db.customers.update({first_name:"John"}, {$inc:{age:5}})`
        - will increment the age by 5
    - $unset operator:
        - `db.customers.update({first_name:"John"}, {$unset:{age:1}}`
        - this will remove the field entirely
    - updating something that isn't there:
        - if the first parm in `update()` doesn't match anything, no changes are made
        - but you can upsert by specifying a third parameter:
            - `db.customers.update({first_name:"Mary"}, {$set:{last_name:"Jones"}}, { upsert: true})`
    - $rename operator:
        -  `db.customers.update({first_name:"Mary"}, {$rename:"gender":"sex"});
        - will change the name of the field
- Removing records
    - `db.customers.remove({first_name:"Steven"})`
        - will delete any matchin records in the collection
    - `db.customers.remove({first_name:"Steven"}, {justOne:true})`
        - will only remove the first match
- Querying
    - `db.customers.find({first_name:"Sharon"})`
    - `db.customers.find({$or: [{first_name:"Sharon"},{first_name:"Troy"}]})`
        - $or operator
    - `db.customers.find({age:{$lt:40}})`
        - there are $lt, $lte, $gte, and $gt operators
    - `db.customers.find({"address.city":"Boston"})`
        - address.city is wrapped in quotes because you're dealing with nested objects now
        - in general, wrapping the fields in quotes is ok too
- Sorting
    - `db.customers.find().sort({last_name:1})`
        - the 1 means ascending order
        - for descending order, use -1
- Counting
    - `db.customers.find().count()`
- Limiting / Take
    - `db.customers.find().limit(4)`
- Iterating
    - `db.customers.find().forEach(function(doc){ print("Customer Name:" + doc.first_name)})`

    

    





